
#JVM

##问题排查命令

### Dump命令

1.通过java -version查看虚拟机版本

2.通过jps查看java进程id, 或者ps -ef | grep java查看java进程的id
```
jps
ps -ef | grep java
```

3.通过jstack制作线程的dump信息, 可以用来查看线程的阻塞或者死锁等问题
```
jstack 进程id >> 文件名
```

Linux环境下制作线程dump
`
kill -quit 进程id
kill -3 进程id
```

4.通过下面的命令制作堆dump信息
```
jmap -histo:live 进程id
```
注意:谨慎使用jmap, jmap命令执行会直接触发一次fullGC

## JIT

just in time - 即时编译

Java代码通常的执行过程是: 生成class文件 --> 解释器翻译为机器码 --> 解释器执行
为了提高代码的执行效率, 可以使用编译器对热点代码就行编译, 将编译后的代码直接缓存其对应的机器码. 一般来说主要是对重复执行的方法和循环代码进行编译，热点代码的是通过JVM的热点嗅探发现.

解释器和编译器执行的过程如下:

calss文件  --> 解释器解释 --> 执行机器码  --> 执行结果

class文件  --> 编译器编译 --> 缓存生成机器码 --> 执行机器码 --> 执行结果

JIT比解释快, 其实说的是“执行编译后的代码”比“解释器解释执行”要快, 并不是说“编译”这个动作比“解释”这个动作快. JIT编译再怎么快, 至少也比解释执行一次略慢一些, 而要得到最后的执行结果还得再经过一个“执行编译后的代码”的过程. 所以, 对“只执行一次”的代码而言, 解释执行其实总是比JIT编译执行要快.
